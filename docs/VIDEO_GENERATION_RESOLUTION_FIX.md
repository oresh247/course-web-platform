# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ" –Ω–∞ —Ñ–æ—Ä–º–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ –¥–ª—è —É—Ä–æ–∫–∞ "–ò—Å—Ç–æ—Ä–∏—è Java" –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ—Ä—ã–≤–∞–ª–∞—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ".

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoints**
- ‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Endpoint `/api/video/generate-lesson` –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ Endpoint `/api/video/status/{video_id}` –¥–æ—Å—Ç—É–ø–µ–Ω

### **2. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**
- ‚úÖ –í–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è (–ø–æ–ª—É—á–∞–µ–º `video_id`)
- ‚ùå –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `status: "unknown"`

### **3. –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ HeyGen API**

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä—è–º–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ HeyGen API:

```python
# –¢–µ—Å—Ç: test_heygen_direct.py
video_id = "2e6c51c2ec9340be95977ee44af35863"
url = f"https://api.heygen.com/v1/video_status.get?video_id={video_id}"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "code": 100,
  "data": {
    "status": "failed",
    "error": {
      "code": "RESOLUTION_NOT_ALLOWED",
      "message": "Please subscribe to higher plan to generate higher resolution videos"
    }
  }
}
```

## –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã

**HeyGen API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É `RESOLUTION_NOT_ALLOWED`** - —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω HeyGen –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.

## –†–µ—à–µ–Ω–∏–µ ‚úÖ

### **1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**

–í `backend/services/heygen_service.py` –∏–∑–º–µ–Ω–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```python
# –ë—ã–ª–æ:
quality: str = "high",

# –°—Ç–∞–ª–æ:
quality: str = "low",
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∏–∑–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞**

–í `backend/services/video_generation_service.py` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

```python
'quality': lesson_data.get('quality', 'low'),
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–∏–∑–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º**

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_video_low_quality.py` —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º:

```python
payload = {
    "title": "–ò—Å—Ç–æ—Ä–∏—è Java",
    "content": test_script,
    "avatar_id": avatar_id,
    "voice_id": voice_id,
    "language": "ru",
    "quality": "low"  # –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
}
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ payload –¥–ª—è HeyGen API:**

```json
{
  "video_inputs": [...],
  "dimension": {
    "width": 1920,  // high quality
    "height": 1080  // high quality
  },
  "quality": "high"  // ‚Üê –ü—Ä–æ–±–ª–µ–º–∞ –∑–¥–µ—Å—å
}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞:**

```json
{
  "video_inputs": [...],
  "dimension": {
    "width": 1280,  // low quality
    "height": 720   // low quality
  },
  "quality": "low"   // ‚Üê –†–µ—à–µ–Ω–∏–µ
}
```

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∫–æ–¥–µ:**

```python
# –í HeyGenService.get_video_status()
if result.get("status") == "failed":
    error_details = result.get("error", {})
    return {
        "status": "failed",
        "error": error_details.get("message", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏"),
        "error_code": error_details.get("code", "unknown"),
        "error_details": error_details,
        "video_id": video_id
    }
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –ø—Ä–µ—Ä—ã–≤–∞–ª–∞—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
- ‚ùå HeyGen API –≤–æ–∑–≤—Ä–∞—â–∞–ª `RESOLUTION_NOT_ALLOWED`
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –í–∏–¥–µ–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å –Ω–∏–∑–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º (1280x720)
- ‚úÖ –û–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–ª–∞–Ω–∞ HeyGen
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **1. –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í–∏–¥–µ–æ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 1280x720 –≤–º–µ—Å—Ç–æ 1920x1080
- –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ

### **2. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `quality: "high"` –≤ –∑–∞–ø—Ä–æ—Å–µ
- –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –ø–ª–∞–Ω HeyGen

### **3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- –°–ª–µ–¥–∏—Ç—å –∑–∞ –æ—à–∏–±–∫–∞–º–∏ `RESOLUTION_NOT_ALLOWED` –≤ –ª–æ–≥–∞—Ö
- –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Ç–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–µ—à–µ–Ω–∞! –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å `"high"` –Ω–∞ `"low"` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–ª–∞–Ω–∞ HeyGen –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤–∏–¥–µ–æ. üöÄ
